@page "/fibonacci"

<h1>Fibonacci Counter</h1>

<p>Current number: @currentNumber</p>

<button class="btn btn-primary" @onclick="GenerateNext">Click me</button>

@code {
	private List<ulong> fibonacci = new List<ulong> { 0 };
		
	private string currentNumber => maxReached 
		? "Max ulong value reached" 
		: fibonacci.Last().ToString("#,0");

	private bool maxReached => SecondToLastNumber > ulong.MaxValue / goldenRatio;

	private ulong SecondToLastNumber => fibonacci.ToArray()
		.Reverse().Skip(1).Take(1).FirstOrDefault();

	private const decimal goldenRatio = 1.618033988m;


	private void GenerateNext()
	{
		if (maxReached) return;

		var lastTwo = fibonacci.ToArray().Reverse().Take(2);
		var sum = lastTwo.First() + lastTwo.Last();

		if (sum == 0) sum = 1; 

		fibonacci.Add(sum);
	}
}
